"use strict";{const e=django.jQuery;let t=0;const n=[];function o(){n.forEach((function(e){e.closed||(e.dismissChildPopups(),e.close())}))}function i(){if(document.getElementsByName("_popup").length>0){const e=window.name.lastIndexOf("__")+2;t=parseInt(window.name.substring(e))}else t=0}function s(e){return e+"__"+(t+1)}function a(e){return e.replace(new RegExp("__"+(t+1)+"$"),"")}function d(e,t,o){const i=s(e.id.replace(t,"")),a=new URL(e.href);o&&a.searchParams.set("_popup",1);const d=window.open(a,i,"height=500,width=800,resizable=yes,scrollbars=yes");return n.push(d),d.focus(),!1}function c(e){return d(e,/^lookup_/,!0)}function l(t,o){const i=a(t.name),s=document.getElementById(i);s.classList.contains("vManyToManyRawIdAdminField")&&s.value?s.value+=","+o:s.value=o,e(s).trigger("change");const d=n.indexOf(t);d>-1&&n.splice(d,1),t.close()}function r(e){return d(e,/^(change|add|delete)_/,!1)}function p(t){const n=e(t),o=n.nextAll(".view-related, .change-related, .delete-related");if(!o.length)return;const i=n.val();i?o.each((function(){const t=e(this);t.attr("href",t.attr("data-href-template").replace("__fk__",i)),t.removeAttr("aria-disabled")})):(o.removeAttr("href"),o.attr("aria-disabled",!0))}function u(e,t,n,o,i,s=[]){const a=t.location.pathname,d=a.split("/")[a.split("/").length-(n?4:3)];document.querySelectorAll(`[data-model-ref="${d}"] [data-context="available-source"]`).forEach((function(t){if(e===t||s&&s.includes(t.id))return;let a=t.querySelector(`option[value="${n}"]`);if(!a)return a=new Option(o,i),t.options.add(a),void(void 0===window.SelectBox||SelectBox.cache[e.id]||(SelectBox.add_to_cache(t.id,a),SelectBox.redisplay(t.id)));a.textContent=o,a.value=i}))}function h(t,o,i){const s=a(t.name),d=document.getElementById(s);if(d){const n=d.nodeName.toUpperCase();"SELECT"===n?(d.options[d.options.length]=new Option(i,o,!0,!0),u(d,t,null,i,o)):"INPUT"===n&&(d.classList.contains("vManyToManyRawIdAdminField")&&d.value?d.value+=","+o:d.value=o),e(d).trigger("change")}else{const e=s+"_to",n=document.getElementById(e),a=new Option(i,o);if(SelectBox.add_to_cache(e,a),SelectBox.redisplay(e),n&&"SELECT"===n.nodeName.toUpperCase()){u(n,t,null,i,o,[s+"_from"])}}const c=n.indexOf(t);c>-1&&n.splice(c,1),t.close()}function f(t,o,i,s){const d=a(t.name.replace(/^edit_/,"")),c=interpolate("#%s, #%s_from, #%s_to",[d,d,d]),l=e(c);l.find("option").each((function(){this.value===o&&(this.textContent=i,this.value=s)})).trigger("change"),u(l[0],t,o,i,s),l.next().find(".select2-selection__rendered").each((function(){this.lastChild.textContent=i,this.title=i}));const r=n.indexOf(t);r>-1&&n.splice(r,1),t.close()}function w(t,o){const i=a(t.name.replace(/^delete_/,"")),s=interpolate("#%s, #%s_from, #%s_to",[i,i,i]);e(s).find("option").each((function(){this.value===o&&e(this).remove()})).trigger("change");const d=n.indexOf(t);d>-1&&n.splice(d,1),t.close()}window.showRelatedObjectLookupPopup=c,window.dismissRelatedLookupPopup=l,window.showRelatedObjectPopup=r,window.updateRelatedObjectLinks=p,window.dismissAddRelatedObjectPopup=h,window.dismissChangeRelatedObjectPopup=f,window.dismissDeleteRelatedObjectPopup=w,window.dismissChildPopups=o,window.relatedWindows=n,window.showAddAnotherPopup=r,window.dismissAddAnotherPopup=h,window.addEventListener("unload",(function(e){window.dismissChildPopups()})),e(document).ready((function(){i(),e("a[data-popup-opener]").on("click",(function(t){t.preventDefault(),opener.dismissRelatedLookupPopup(window,e(this).data("popup-opener"))})),e("body").on("click",'.related-widget-wrapper-link[data-popup="yes"]',(function(t){if(t.preventDefault(),this.href){const t=e.Event("django:show-related",{href:this.href});e(this).trigger(t),t.isDefaultPrevented()||r(this)}})),e("body").on("change",".related-widget-wrapper select",(function(t){const n=e.Event("django:update-related");e(this).trigger(n),n.isDefaultPrevented()||p(this)})),e(".related-widget-wrapper select").trigger("change"),e("body").on("click",".related-lookup",(function(t){t.preventDefault();const n=e.Event("django:lookup-related");e(this).trigger(n),n.isDefaultPrevented()||c(this)}))}))}