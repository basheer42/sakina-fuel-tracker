"use strict";{const e=django.jQuery;e.fn.formset=function(t){const s=e.extend({},e.fn.formset.defaults,t),n=e(this),a=n.parent(),i=function(t,s,n){const a=new RegExp("("+s+"-(\\d+|__prefix__))"),i=s+"-"+n;e(t).prop("for")&&e(t).prop("for",e(t).prop("for").replace(a,i)),t.id&&(t.id=t.id.replace(a,i)),t.name&&(t.name=t.name.replace(a,i))},l=e("#id_"+s.prefix+"-TOTAL_FORMS").prop("autocomplete","off");let d=parseInt(l.val(),10);const o=e("#id_"+s.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),r=e("#id_"+s.prefix+"-MIN_NUM_FORMS").prop("autocomplete","off");let f;const c=function(t){t.preventDefault();const n=e("#"+s.prefix+"-empty"),a=n.clone(!0);a.removeClass(s.emptyCssClass).addClass(s.formCssClass).attr("id",s.prefix+"-"+d),p(a),a.find("*").each((function(){i(this,s.prefix,l.val())})),a.insertBefore(e(n)),e(l).val(parseInt(l.val(),10)+1),d+=1,""!==o.val()&&o.val()-l.val()<=0&&f.parent().hide(),m(a.closest(".inline-group")),s.added&&s.added(a),a.get(0).dispatchEvent(new CustomEvent("formset:added",{bubbles:!0,detail:{formsetName:s.prefix}}))},p=function(e){e.is("tr")?e.children(":last").append('<div><a role="button" class="'+s.deleteCssClass+'" href="#">'+s.deleteText+"</a></div>"):e.is("ul")||e.is("ol")?e.append('<li><a role="button" class="'+s.deleteCssClass+'" href="#">'+s.deleteText+"</a></li>"):e.children(":first").append('<span><a role="button" class="'+s.deleteCssClass+'" href="#">'+s.deleteText+"</a></span>"),e.find("a."+s.deleteCssClass).on("click",u.bind(this))},u=function(t){t.preventDefault();const n=e(t.target).closest("."+s.formCssClass),a=n.closest(".inline-group"),l=n.prev();l.length&&l.hasClass("row-form-errors")&&l.remove(),n.remove(),d-=1,s.removed&&s.removed(n),document.dispatchEvent(new CustomEvent("formset:removed",{detail:{formsetName:s.prefix}}));const r=e("."+s.formCssClass);let c,p;e("#id_"+s.prefix+"-TOTAL_FORMS").val(r.length),(""===o.val()||o.val()-r.length>0)&&f.parent().show(),m(a);const u=function(){i(this,s.prefix,c)};for(c=0,p=r.length;c<p;c++)i(e(r).get(c),s.prefix,c),e(r.get(c)).find("*").each(u)},m=function(e){""!==r.val()&&r.val()-l.val()>=0?e.find(".inline-deletelink").hide():e.find(".inline-deletelink").show()};n.each((function(t){e(this).not("."+s.emptyCssClass).addClass(s.formCssClass)})),n.filter("."+s.formCssClass+":not(.has_original):not(."+s.emptyCssClass+")").each((function(){p(e(this))})),m(n),f=s.addButton,function(){if(null===f)if("TR"===n.prop("tagName")){const e=n.eq(-1).children().length;a.append('<tr class="'+s.addCssClass+'"><td colspan="'+e+'"><a role="button" class="addlink" href="#">'+s.addText+"</a></tr>"),f=a.find("tr:last a")}else n.filter(":last").after('<div class="'+s.addCssClass+'"><a role="button" class="addlink" href="#">'+s.addText+"</a></div>"),f=n.filter(":last").next().find("a");f.on("click",c)}();const h=""===o.val()||o.val()-l.val()>0;return n.length&&h?f.parent().show():f.parent().hide(),this},e.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null,addButton:null},e.fn.tabularFormset=function(t,s){const n=e(this);return n.formset({prefix:s.prefix,addText:s.addText,formCssClass:"dynamic-"+s.prefix,deleteCssClass:"inline-deletelink",deleteText:s.deleteText,emptyCssClass:"empty-form",added:function(t){!function(t){t.find(".prepopulated_field").each((function(){const s=e(this).find("input, select, textarea"),n=s.data("dependency_list")||[],a=[];e.each(n,(function(e,s){a.push("#"+t.find(".field-"+s).find("input, select, textarea").attr("id"))})),a.length&&s.prepopulate(a,s.attr("maxlength"))}))}(t),"undefined"!=typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),"undefined"!=typeof SelectFilter&&(e(".selectfilter").each((function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!1)})),e(".selectfilterstacked").each((function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!0)})))},addButton:s.addButton}),n},e.fn.stackedFormset=function(t,s){const n=e(this),a=function(s){e(t).find(".inline_label").each((function(t){const s=t+1;e(this).html(e(this).html().replace(/(#\d+)/g,"#"+s))}))};return n.formset({prefix:s.prefix,addText:s.addText,formCssClass:"dynamic-"+s.prefix,deleteCssClass:"inline-deletelink",deleteText:s.deleteText,emptyCssClass:"empty-form",removed:a,added:function(t){!function(t){t.find(".prepopulated_field").each((function(){const s=e(this).find("input, select, textarea"),n=s.data("dependency_list")||[],a=[];e.each(n,(function(e,s){let n=t.find(".form-row .field-"+s);n.length||(n=t.find(".form-row.field-"+s)),a.push("#"+n.find("input, select, textarea").attr("id"))})),a.length&&s.prepopulate(a,s.attr("maxlength"))}))}(t),"undefined"!=typeof DateTimeShortcuts&&(e(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),"undefined"!=typeof SelectFilter&&(e(".selectfilter").each((function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!1)})),e(".selectfilterstacked").each((function(e,t){SelectFilter.init(t.id,this.dataset.fieldName,!0)}))),a()},addButton:s.addButton}),n},e(document).ready((function(){e(".js-inline-admin-formset").each((function(){const t=e(this).data(),s=t.inlineFormset;let n;switch(t.inlineType){case"stacked":n=s.name+"-group .inline-related",e(n).stackedFormset(n,s.options);break;case"tabular":n=s.name+"-group .tabular.inline-related tbody:first > tr.form-row",e(n).tabularFormset(n,s.options)}}))}))}